(function(_e){"use strict";var D,b,he,L,ve,me,J,Y,Z,Q,I={},ge=[],Xe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ee=Array.isArray;function T(e,t){for(var n in t)e[n]=t[n];return e}function ye(e){var t=e.parentNode;t&&t.removeChild(e)}function be(e,t,n){var o,r,a,d={};for(a in t)a=="key"?o=t[a]:a=="ref"?r=t[a]:d[a]=t[a];if(arguments.length>2&&(d.children=arguments.length>3?D.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)d[a]===void 0&&(d[a]=e.defaultProps[a]);return R(e,d,o,r,null)}function R(e,t,n,o,r){var a={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++he,__i:-1,__u:0};return r==null&&b.vnode!=null&&b.vnode(a),a}function W(e){return e.children}function j(e,t){this.props=e,this.context=t}function M(e,t){if(t==null)return e.__?M(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?M(e):null}function xe(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return xe(e)}}function we(e){(!e.__d&&(e.__d=!0)&&L.push(e)&&!B.__r++||ve!==b.debounceRendering)&&((ve=b.debounceRendering)||me)(B)}function B(){var e,t,n,o,r,a,d,u;for(L.sort(J);e=L.shift();)e.__d&&(t=L.length,o=void 0,a=(r=(n=e).__v).__e,d=[],u=[],n.__P&&((o=T({},r)).__v=r.__v+1,b.vnode&&b.vnode(o),te(n.__P,o,r,n.__n,n.__P.namespaceURI,32&r.__u?[a]:null,d,a??M(r),!!(32&r.__u),u),o.__v=r.__v,o.__.__k[o.__i]=o,Te(d,o,u),o.__e!=a&&xe(o)),L.length>t&&L.sort(J));B.__r=0}function ke(e,t,n,o,r,a,d,u,c,s,p){var i,m,f,g,y,h=o&&o.__k||ge,_=t.length;for(n.__d=c,Je(n,t,h),c=n.__d,i=0;i<_;i++)(f=n.__k[i])!=null&&typeof f!="boolean"&&typeof f!="function"&&(m=f.__i===-1?I:h[f.__i]||I,f.__i=i,te(e,f,m,r,a,d,u,c,s,p),g=f.__e,f.ref&&m.ref!=f.ref&&(m.ref&&ne(m.ref,null,f),p.push(f.ref,f.__c||g,f)),y==null&&g!=null&&(y=g),65536&f.__u||m.__k===f.__k?c=Se(f,c,e):typeof f.type=="function"&&f.__d!==void 0?c=f.__d:g&&(c=g.nextSibling),f.__d=void 0,f.__u&=-196609);n.__d=c,n.__e=y}function Je(e,t,n){var o,r,a,d,u,c=t.length,s=n.length,p=s,i=0;for(e.__k=[],o=0;o<c;o++)d=o+i,(r=e.__k[o]=(r=t[o])==null||typeof r=="boolean"||typeof r=="function"?null:typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?R(null,r,null,null,null):ee(r)?R(W,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?R(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)!=null?(r.__=e,r.__b=e.__b+1,u=Ye(r,n,d,p),r.__i=u,a=null,u!==-1&&(p--,(a=n[u])&&(a.__u|=131072)),a==null||a.__v===null?(u==-1&&i--,typeof r.type!="function"&&(r.__u|=65536)):u!==d&&(u==d-1?i--:u==d+1?i++:u>d?p>c-d?i+=u-d:i--:u<d&&(u==d-i?i-=u-d:i++),u!==o+i&&(r.__u|=65536))):(a=n[d])&&a.key==null&&a.__e&&!(131072&a.__u)&&(a.__e==e.__d&&(e.__d=M(a)),oe(a,a,!1),n[d]=null,p--);if(p)for(o=0;o<s;o++)(a=n[o])!=null&&!(131072&a.__u)&&(a.__e==e.__d&&(e.__d=M(a)),oe(a,a))}function Se(e,t,n){var o,r;if(typeof e.type=="function"){for(o=e.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=e,t=Se(o[r],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=M(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function Ye(e,t,n,o){var r=e.key,a=e.type,d=n-1,u=n+1,c=t[n];if(c===null||c&&r==c.key&&a===c.type&&!(131072&c.__u))return n;if(o>(c!=null&&!(131072&c.__u)?1:0))for(;d>=0||u<t.length;){if(d>=0){if((c=t[d])&&!(131072&c.__u)&&r==c.key&&a===c.type)return d;d--}if(u<t.length){if((c=t[u])&&!(131072&c.__u)&&r==c.key&&a===c.type)return u;u++}}return-1}function Ee(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Xe.test(t)?n:n+"px"}function z(e,t,n,o,r){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||Ee(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||Ee(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?o?n.u=o.u:(n.u=Y,e.addEventListener(t,a?Q:Z,a)):e.removeEventListener(t,a?Q:Z,a);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Ce(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Y++;else if(t.t<n.u)return;return n(b.event?b.event(t):t)}}}function te(e,t,n,o,r,a,d,u,c,s){var p,i,m,f,g,y,h,_,v,k,S,H,U,Ve,V,fe,C=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(c=!!(32&n.__u),a=[u=t.__e=n.__e]),(p=b.__b)&&p(t);e:if(typeof C=="function")try{if(_=t.props,v="prototype"in C&&C.prototype.render,k=(p=C.contextType)&&o[p.__c],S=p?k?k.props.value:p.__:o,n.__c?h=(i=t.__c=n.__c).__=i.__E:(v?t.__c=i=new C(_,S):(t.__c=i=new j(_,S),i.constructor=C,i.render=Qe),k&&k.sub(i),i.props=_,i.state||(i.state={}),i.context=S,i.__n=o,m=i.__d=!0,i.__h=[],i._sb=[]),v&&i.__s==null&&(i.__s=i.state),v&&C.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=T({},i.__s)),T(i.__s,C.getDerivedStateFromProps(_,i.__s))),f=i.props,g=i.state,i.__v=t,m)v&&C.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),v&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(v&&C.getDerivedStateFromProps==null&&_!==f&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(_,S),!i.__e&&(i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(_,i.__s,S)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(i.props=_,i.state=i.__s,i.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(X){X&&(X.__=t)}),H=0;H<i._sb.length;H++)i.__h.push(i._sb[H]);i._sb=[],i.__h.length&&d.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(_,i.__s,S),v&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(f,g,y)})}if(i.context=S,i.props=_,i.__P=e,i.__e=!1,U=b.__r,Ve=0,v){for(i.state=i.__s,i.__d=!1,U&&U(t),p=i.render(i.props,i.state,i.context),V=0;V<i._sb.length;V++)i.__h.push(i._sb[V]);i._sb=[]}else do i.__d=!1,U&&U(t),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++Ve<25);i.state=i.__s,i.getChildContext!=null&&(o=T(T({},o),i.getChildContext())),v&&!m&&i.getSnapshotBeforeUpdate!=null&&(y=i.getSnapshotBeforeUpdate(f,g)),ke(e,ee(fe=p!=null&&p.type===W&&p.key==null?p.props.children:p)?fe:[fe],t,n,o,r,a,d,u,c,s),i.base=t.__e,t.__u&=-161,i.__h.length&&d.push(i),h&&(i.__E=i.__=null)}catch(X){if(t.__v=null,c||a!=null){for(t.__u|=c?160:32;u&&u.nodeType===8&&u.nextSibling;)u=u.nextSibling;a[a.indexOf(u)]=null,t.__e=u}else t.__e=n.__e,t.__k=n.__k;b.__e(X,t,n)}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Ze(n.__e,t,n,o,r,a,d,c,s);(p=b.diffed)&&p(t)}function Te(e,t,n){t.__d=void 0;for(var o=0;o<n.length;o++)ne(n[o],n[++o],n[++o]);b.__c&&b.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(a){a.call(r)})}catch(a){b.__e(a,r.__v)}})}function Ze(e,t,n,o,r,a,d,u,c){var s,p,i,m,f,g,y,h=n.props,_=t.props,v=t.type;if(v==="svg"?r="http://www.w3.org/2000/svg":v==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),a!=null){for(s=0;s<a.length;s++)if((f=a[s])&&"setAttribute"in f==!!v&&(v?f.localName===v:f.nodeType===3)){e=f,a[s]=null;break}}if(e==null){if(v===null)return document.createTextNode(_);e=document.createElementNS(r,v,_.is&&_),a=null,u=!1}if(v===null)h===_||u&&e.data===_||(e.data=_);else{if(a=a&&D.call(e.childNodes),h=n.props||I,!u&&a!=null)for(h={},s=0;s<e.attributes.length;s++)h[(f=e.attributes[s]).name]=f.value;for(s in h)if(f=h[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=f;else if(s!=="key"&&!(s in _)){if(s=="value"&&"defaultValue"in _||s=="checked"&&"defaultChecked"in _)continue;z(e,s,null,f,r)}}for(s in _)f=_[s],s=="children"?m=f:s=="dangerouslySetInnerHTML"?p=f:s=="value"?g=f:s=="checked"?y=f:s==="key"||u&&typeof f!="function"||h[s]===f||z(e,s,f,h[s],r);if(p)u||i&&(p.__html===i.__html||p.__html===e.innerHTML)||(e.innerHTML=p.__html),t.__k=[];else if(i&&(e.innerHTML=""),ke(e,ee(m)?m:[m],t,n,o,v==="foreignObject"?"http://www.w3.org/1999/xhtml":r,a,d,a?a[0]:n.__k&&M(n,0),u,c),a!=null)for(s=a.length;s--;)a[s]!=null&&ye(a[s]);u||(s="value",g!==void 0&&(g!==e[s]||v==="progress"&&!g||v==="option"&&g!==h[s])&&z(e,s,g,h[s],r),s="checked",y!==void 0&&y!==e[s]&&z(e,s,y,h[s],r))}return e}function ne(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(r){b.__e(r,n)}}function oe(e,t,n){var o,r;if(b.unmount&&b.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||ne(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(a){b.__e(a,t)}o.base=o.__P=null}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&oe(o[r],t,n||typeof e.type!="function");n||e.__e==null||ye(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function Qe(e,t,n){return this.constructor(e,n)}function Le(e,t,n){var o,r,a,d;b.__&&b.__(e,t),r=(o=!1)?null:t.__k,a=[],d=[],te(t,e=t.__k=be(W,null,[e]),r||I,I,t.namespaceURI,r?null:t.firstChild?D.call(t.childNodes):null,a,r?r.__e:t.firstChild,o,d),Te(a,e,d)}D=ge.slice,b={__e:function(e,t,n,o){for(var r,a,d;t=t.__;)if((r=t.__c)&&!r.__)try{if((a=r.constructor)&&a.getDerivedStateFromError!=null&&(r.setState(a.getDerivedStateFromError(e)),d=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,o||{}),d=r.__d),d)return r.__E=r}catch(u){e=u}throw e}},he=0,j.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=T({},this.state),typeof e=="function"&&(e=e(T({},n),this.props)),e&&T(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),we(this))},j.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),we(this))},j.prototype.render=W,L=[],me=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,J=function(e,t){return e.__v.__b-t.__v.__b},B.__r=0,Y=0,Z=Ce(!1),Q=Ce(!0);const et=['[role="grid"]',"[data-board]",".board","main .grid-3x3"],tt=['[role="gridcell"]',"[data-cell]",".cell","button","div"],nt=["[data-outcome]","[aria-live]",".result"];function Me(){const e={candidates:[],chosen:null};let t=null,n=[];for(const r of et){const a=Array.from(document.querySelectorAll(r));for(const d of a){const u=Array.from(d.querySelectorAll(tt.join(",")));if(u.length===9||rt(d)){t=d,n=it(u),e.chosen=r;break}}if(e.candidates.push(`${r}:${a.length}`),t)break}const o=ot(nt);return{board:t,cells:n,outcome:o,debug:e}}function ot(e){for(const t of e){const n=document.querySelector(t);if(n)return n}return null}function rt(e){const t=e.getBoundingClientRect();return Math.abs(t.width-t.height)/Math.max(1,t.width)<.2}function it(e){if(e.length===9)return e.slice(0,9);const t=e.filter(n=>at(n)).slice(0,9);return t.length===9?t:e.slice(0,9)}function at(e){const t=e.getAttribute("role");return e.tagName==="BUTTON"||e.onclick!=null||t==="button"||t==="gridcell"}function ct(e){return e?e.map(t=>{const n=(t.textContent||"").trim().toUpperCase();return n.includes("X")?"X":n.includes("O")?"O":null}):Array(9).fill(null)}function st(e){const t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const o of t){const[r,a,d]=o;if(e[r]&&e[r]===e[a]&&e[r]===e[d])return{winner:e[r],line:o,draw:!1}}return{winner:null,line:null,draw:e.every(Boolean)}}function lt(e){const t=e.filter(o=>o==="X").length,n=e.filter(o=>o==="O").length;return t<=n?"X":"O"}function dt(e){const t=new MutationObserver(()=>e());t.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0,characterData:!0});const n=new ResizeObserver(()=>e());n.observe(document.documentElement);const o=()=>{try{t.disconnect()}catch{}try{n.disconnect()}catch{}};return window.addEventListener("hashchange",e),window.addEventListener("popstate",e),()=>{o(),window.removeEventListener("hashchange",e),window.removeEventListener("popstate",e)}}const Oe="ttt-ui-enhancer:v1";function ut(){try{const e="__ttt_test__";return window.localStorage.setItem(e,"1"),window.localStorage.removeItem(e),window.localStorage}catch{let e={};return{getItem:t=>t in e?e[t]:null,setItem:(t,n)=>{e[t]=String(n)}}}}const Pe=ut();function pt(){const e=Pe.getItem(Oe),t={prefs:{theme:"dark",fontScale:1,reduceMotion:typeof matchMedia=="function"?matchMedia("(prefers-reduced-motion: reduce)").matches:!1,ghostMarks:!0,sounds:!1,volume:.3,haptics:!1,tooltips:!0,tipsOnStart:!0,dyslexiaFont:!1},discovery:{board:null,cells:[],outcome:null,debug:{candidates:[],chosen:null}},panelOpen:!1,shortcutsOpen:!1};if(e)try{const n=JSON.parse(e);Object.assign(t.prefs,n.prefs||n)}catch{}return t}function ft(e){let t=e;const n=new Set,o={getState:()=>t,setState:r=>{const{prefs:a,...d}=r,u=a?{...t.prefs,...a}:t.prefs;t={...t,...d,prefs:u},$e(t.prefs),n.forEach(c=>_t(()=>c(t)))},subscribe:r=>(n.add(r),()=>n.delete(r))};return $e(t.prefs),Ae(t.prefs),o}function $e(e){Pe.setItem(Oe,JSON.stringify({prefs:e})),Ae(e)}function Ae(e){const t=document.querySelector(".ttt-enhancer-root"),n=t==null?void 0:t.classList;n&&(n.remove("theme-light","theme-dark","theme-high-contrast","theme-protanopia","theme-deuteranopia","theme-tritanopia","font-dyslexia"),n.add(`theme-${e.theme}`),e.dyslexiaFont&&n.add("font-dyslexia"),t.style.setProperty("--font-scale",String(e.fontScale)))}function _t(e){try{e()}catch{}}const ht=".ttt-enhancer.theme-dark{--color-bg: #0b0c0f;--color-surface: #151821;--color-text: #e6eaf2;--color-muted: #a7b0c3;--color-accent: #6aa9ff;--color-win: #30d158;--color-lose: #ff453a;--color-draw: #ffd60a}",vt=".ttt-enhancer.theme-deuteranopia{--color-accent: #0ea5e9;--color-win: #22c55e;--color-lose: #eab308}",mt=".ttt-enhancer.font-dyslexia{--font-sans: var(--font-dyslexia)}",gt=".ttt-enhancer.theme-high-contrast{--color-bg: #000000;--color-surface: #000000;--color-text: #ffffff;--color-muted: #e5e7eb;--color-accent: #ffff00;--color-win: #00ff00;--color-lose: #ff0000;--color-draw: #00ffff;--ring-focus: 0 0 0 3px rgba(255, 255, 0, .9)}",yt=".ttt-enhancer.theme-light{--color-bg: #f7f8fb;--color-surface: #ffffff;--color-text: #0b0c0f;--color-muted: #4b5563;--color-accent: #3b82f6;--color-win: #16a34a;--color-lose: #dc2626;--color-draw: #ca8a04}",bt=".ttt-enhancer.theme-protanopia{--color-accent: #0ea5e9;--color-win: #10b981;--color-lose: #f97316}",xt=".ttt-enhancer.theme-tritanopia{--color-accent: #f97316;--color-win: #22c55e;--color-lose: #ef4444}",wt=':root .ttt-enhancer,.ttt-enhancer :root{--color-bg: #0b0c0f;--color-surface: #151821;--color-text: #e6eaf2;--color-muted: #a7b0c3;--color-accent: #6aa9ff;--color-win: #30d158;--color-lose: #ff453a;--color-draw: #ffd60a;--ring-focus: 0 0 0 3px rgba(106, 169, 255, .55);--shadow-sm: 0 1px 2px rgba(0,0,0,.2);--shadow-md: 0 8px 20px rgba(0,0,0,.35);--shadow-lg: 0 22px 60px rgba(0,0,0,.45);--radius-sm: 6px;--radius-md: 10px;--radius-lg: 16px;--radius-xl: 24px;--space-1: 4px;--space-2: 8px;--space-3: 12px;--space-4: 16px;--space-5: 24px;--space-6: 32px;--space-7: 48px;--space-8: 64px;--font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";--font-dyslexia: "OpenDyslexic", var(--font-sans);--font-scale: 1;--panel-bg: color-mix(in srgb, var(--color-surface) 85%, black 15%);--panel-border: 1px solid rgba(255,255,255,.08)}.ttt-enhancer{--safe-top: env(safe-area-inset-top, 0px);--safe-right: env(safe-area-inset-right, 0px);--safe-bottom: env(safe-area-inset-bottom, 0px);--safe-left: env(safe-area-inset-left, 0px);font-family:var(--font-sans)}.ttt-enhancer-root{z-index:2147483646}.ttt-enhancer .ttt-gear{position:fixed;right:calc(12px + var(--safe-right));bottom:calc(12px + var(--safe-bottom));width:44px;height:44px;border-radius:999px;background:var(--panel-bg);box-shadow:var(--shadow-md);border:var(--panel-border);display:grid;place-items:center;color:var(--color-text);pointer-events:auto;cursor:pointer}.ttt-enhancer .ttt-gear:focus-visible{outline:none;box-shadow:var(--ring-focus)}.ttt-enhancer .ttt-panel{position:fixed;pointer-events:auto;right:calc(12px + var(--safe-right));bottom:calc(64px + 20px + var(--safe-bottom));width:min(420px,calc(100vw - 24px));max-height:min(70vh,calc(100vh - 160px));background:var(--panel-bg);color:var(--color-text);border-radius:var(--radius-lg);border:var(--panel-border);box-shadow:var(--shadow-lg);overflow:hidden;display:none}.ttt-enhancer .ttt-panel.open{display:grid;grid-template-rows:auto 1fr}.ttt-enhancer .ttt-panel-header{display:flex;align-items:center;justify-content:space-between;padding:var(--space-3) var(--space-4);border-bottom:var(--panel-border)}.ttt-enhancer .ttt-panel-title{font-weight:600}.ttt-enhancer .ttt-panel-body{padding:var(--space-4);overflow:auto}.ttt-enhancer .ttt-panel-controls{display:grid;gap:var(--space-3)}.ttt-enhancer .ttt-row{display:flex;align-items:center;justify-content:space-between;gap:var(--space-3)}.ttt-enhancer .ttt-row>label{font-size:14px;color:var(--color-muted)}.ttt-enhancer .ttt-select,.ttt-enhancer .ttt-input,.ttt-enhancer .ttt-checkbox{pointer-events:auto}.ttt-enhancer .ttt-skip{position:fixed;left:calc(8px + var(--safe-left));top:calc(8px + var(--safe-top));padding:8px 12px;background:var(--color-surface);color:var(--color-text);border-radius:var(--radius-md);border:var(--panel-border);box-shadow:var(--shadow-sm);opacity:0;pointer-events:none;transform:translateY(-6px)}.ttt-enhancer .ttt-skip:focus{opacity:1;pointer-events:auto;transform:none;box-shadow:var(--ring-focus);outline:none}.ttt-enhancer .ttt-tooltip{position:fixed;background:var(--color-surface);color:var(--color-text);border:var(--panel-border);border-radius:var(--radius-sm);box-shadow:var(--shadow-sm);padding:6px 8px;font-size:12px;opacity:0;pointer-events:none;transition:opacity .12s ease}.ttt-enhancer .ttt-tooltip.show{opacity:1}.ttt-enhancer .ttt-toasts{position:fixed;left:50%;transform:translate(-50%);bottom:calc(80px + var(--safe-bottom));display:grid;gap:8px;pointer-events:none}.ttt-enhancer .ttt-toast{background:var(--color-surface);color:var(--color-text);border:var(--panel-border);border-radius:var(--radius-md);box-shadow:var(--shadow-md);padding:8px 12px}.ttt-enhancer .ttt-overlay{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.ttt-enhancer .ttt-canvas{position:absolute;top:0;right:0;bottom:0;left:0}.ttt-enhancer .ttt-shortcuts{position:fixed;top:0;right:0;bottom:0;left:0;display:none;align-items:center;justify-content:center;background:#00000080;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);pointer-events:auto}.ttt-enhancer .ttt-shortcuts.open{display:flex}.ttt-enhancer .ttt-shortcuts-panel{width:min(720px,92vw);max-height:80vh;overflow:auto;background:var(--panel-bg);color:var(--color-text);border:var(--panel-border);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:18px 20px}.ttt-enhancer .ttt-coach-scrim{position:fixed;top:0;right:0;bottom:0;left:0;background:#0000008c;pointer-events:auto;display:none}.ttt-enhancer .ttt-coach-scrim.open{display:block}.ttt-enhancer .ttt-coach-highlight{position:fixed;border-radius:12px;outline:2px dashed var(--color-accent);outline-offset:2px;pointer-events:none}.ttt-enhancer .ttt-coach-panel{position:fixed;max-width:min(420px,92vw);background:var(--panel-bg);color:var(--color-text);border:var(--panel-border);border-radius:var(--radius-lg);box-shadow:var(--shadow-md);padding:12px 14px;pointer-events:auto}.ttt-enhancer .ttt-skeleton{background:linear-gradient(90deg,#ffffff0f,#ffffff1f,#ffffff0f);background-size:200% 100%;animation:ttt-shimmer 1.2s infinite}@keyframes ttt-shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.ttt-enhancer{font-size:calc(16px * var(--font-scale))}.ttt-enhancer .hc-text{color:var(--color-text);text-shadow:0 1px 0 rgba(0,0,0,.6)}';function kt(e){if(document.getElementById(e))return;const t=document.createElement("style");t.id=e,t.textContent=[wt,yt,ht,gt,bt,vt,xt,mt].join(`

`),document.head.appendChild(t)}var St=0;function l(e,t,n,o,r,a){t||(t={});var d,u,c=t;if("ref"in c)for(u in c={},t)u=="ref"?d=t[u]:c[u]=t[u];var s={type:e,props:c,key:n,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--St,__i:-1,__u:0,__source:r,__self:a};if(typeof e=="function"&&(d=e.defaultProps))for(u in d)c[u]===void 0&&(c[u]=d[u]);return b.vnode&&b.vnode(s),s}var F,x,re,He,N=0,Ie=[],w=b,Fe=w.__b,Ne=w.__r,Ue=w.diffed,De=w.__c,Re=w.unmount,We=w.__;function ie(e,t){w.__h&&w.__h(x,e,N||t),N=0;var n=x.__H||(x.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function O(e){return N=1,Et(ze,e)}function Et(e,t,n){var o=ie(F++,2);if(o.t=e,!o.__c&&(o.__=[ze(void 0,t),function(u){var c=o.__N?o.__N[0]:o.__[0],s=o.t(c,u);c!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=x,!x.u)){var r=function(u,c,s){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(m){return!!m.__c});if(p.every(function(m){return!m.__N}))return!a||a.call(this,u,c,s);var i=!1;return p.forEach(function(m){if(m.__N){var f=m.__[0];m.__=m.__N,m.__N=void 0,f!==m.__[0]&&(i=!0)}}),!(!i&&o.__c.props===u)&&(!a||a.call(this,u,c,s))};x.u=!0;var a=x.shouldComponentUpdate,d=x.componentWillUpdate;x.componentWillUpdate=function(u,c,s){if(this.__e){var p=a;a=void 0,r(u,c,s),a=p}d&&d.call(this,u,c,s)},x.shouldComponentUpdate=r}return o.__N||o.__}function E(e,t){var n=ie(F++,3);!w.__s&&Be(n.__H,t)&&(n.__=e,n.i=t,x.__H.__h.push(n))}function $(e){return N=5,q(function(){return{current:e}},[])}function q(e,t){var n=ie(F++,7);return Be(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function ae(e,t){return N=8,q(function(){return e},t)}function Ct(){for(var e;e=Ie.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(G),e.__H.__h.forEach(ce),e.__H.__h=[]}catch(t){e.__H.__h=[],w.__e(t,e.__v)}}w.__b=function(e){x=null,Fe&&Fe(e)},w.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),We&&We(e,t)},w.__r=function(e){Ne&&Ne(e),F=0;var t=(x=e.__c).__H;t&&(re===x?(t.__h=[],x.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(t.__h.forEach(G),t.__h.forEach(ce),t.__h=[],F=0)),re=x},w.diffed=function(e){Ue&&Ue(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ie.push(t)!==1&&He===w.requestAnimationFrame||((He=w.requestAnimationFrame)||Tt)(Ct)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),re=x=null},w.__c=function(e,t){t.some(function(n){try{n.__h.forEach(G),n.__h=n.__h.filter(function(o){return!o.__||ce(o)})}catch(o){t.some(function(r){r.__h&&(r.__h=[])}),t=[],w.__e(o,n.__v)}}),De&&De(e,t)},w.unmount=function(e){Re&&Re(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{G(o)}catch(r){t=r}}),n.__H=void 0,t&&w.__e(t,n.__v))};var je=typeof requestAnimationFrame=="function";function Tt(e){var t,n=function(){clearTimeout(o),je&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,100);je&&(t=requestAnimationFrame(n))}function G(e){var t=x,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),x=t}function ce(e){var t=x;e.__c=e.__(),x=t}function Be(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function ze(e,t){return typeof t=="function"?t(e):t}function qe(e){const t=e.getState().discovery.cells,n=ct(t),{winner:o,line:r,draw:a}=st(n);return{board:n,next:lt(n),winner:o,draw:a,winLine:r}}function Lt(e){const t=e.target;if(!t)return!1;const n=t.tagName;return(t.getAttribute("contenteditable")||"").toLowerCase()==="true"||n==="INPUT"||n==="TEXTAREA"||t.type==="text"}function se(e,t){const n=document.getElementById(e);n&&(n.textContent=t)}function Mt(e,t){if(t)return;const n=document.createElement("canvas");n.width=e.clientWidth,n.height=e.clientHeight,n.style.position="absolute",n.style.inset="0",n.style.pointerEvents="none",e.appendChild(n);const o=n.getContext("2d"),r=Array.from({length:120},()=>({x:Math.random()*n.width,y:-10,vx:(Math.random()-.5)*4,vy:Math.random()*2+2,size:Math.random()*6+3,color:Ot(),life:Math.random()*120+60}));let a=0;function d(){a++,o.clearRect(0,0,n.width,n.height);let u=0;for(const c of r)c.x+=c.vx,c.y+=c.vy,c.vy+=.05,c.life-=1,c.life>0&&c.y<n.height+20&&(u++,o.save(),o.translate(c.x,c.y),o.rotate((c.x+c.y+a)%360*Math.PI/180),o.fillStyle=c.color,o.fillRect(-c.size/2,-c.size/2,c.size,c.size),o.restore());u>0&&a<600?requestAnimationFrame(d):n.remove()}requestAnimationFrame(d)}function Ot(){const e=["#6aa9ff","#30d158","#ff453a","#ffd60a","#f97316","#22c55e"];return e[Math.floor(Math.random()*e.length)]}function Pt(e=10){if("vibrate"in navigator)try{navigator.vibrate(e)}catch{}}let A=null;function $t(e=.2){K(440,.05,e)}function At(e=.25){K(660,.08,e),setTimeout(()=>K(880,.12,e),90)}function Ht(e=.25){K(330,.06,e)}function K(e,t,n){if(!A)try{A=new AudioContext}catch{return}const o=A.createOscillator(),r=A.createGain();o.connect(r),r.connect(A.destination),o.type="sine",o.frequency.value=e,r.gain.value=n,o.start(),o.stop(A.currentTime+t)}const It=e=>l("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[l("path",{d:"M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"}),l("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.5V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.5 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.5-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.5-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.5V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.5 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .65.38 1.24.97 1.5.2.09.42.13.64.13H21a2 2 0 1 1 0 4h-.09c-.22 0-.44.04-.64.13-.59.26-.97.85-.97 1.49Z"})]}),le=e=>l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Ft=e=>l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[l("path",{d:"M9 9a3 3 0 1 1 6 0c0 2-3 2-3 4"}),l("line",{x1:"12",y1:"17",x2:"12",y2:"17"}),l("circle",{cx:"12",cy:"12",r:"10"})]}),Nt=e=>l("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),l("line",{x1:"12",y1:"8",x2:"12",y2:"8"})]}),Ut=e=>l("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:l("polyline",{points:"9 18 15 12 9 6"})}),Ge="ttt-ui-enhancer:coach-dismissed";function Dt({store:e}){const[t,n]=O(!1),[o,r]=O(0),a=$(null),d=$(null),{prefs:u,discovery:c}=e.getState(),s=q(()=>{const h=Rt(["[data-new]",".new-game","button"]);return[{key:"board",title:"Game Board",body:"Overlay adds focus rings, previews, and winning animations.",anchor:c.board||void 0},{key:"new",title:"New Game",body:"Use the host app’s new game button to restart. We never replace controls.",anchor:h||void 0},{key:"outcome",title:"Outcome",body:"Wins show an animated line and optional confetti.",anchor:c.outcome||c.board||void 0}]},[c.board,c.outcome]);E(()=>{if(!u.tipsOnStart||localStorage.getItem(Ge)==="1")return;const h=window.setTimeout(()=>n(!0),800);return()=>window.clearTimeout(h)},[u.tipsOnStart]);const p=ae(()=>{if(!t)return;const h=s[o];if(!(h!=null&&h.anchor))return;const _=h.anchor.getBoundingClientRect(),v=a.current,k=d.current;if(!v||!k)return;v.style.left=`${_.left-6}px`,v.style.top=`${_.top-6}px`,v.style.width=`${_.width+12}px`,v.style.height=`${_.height+12}px`;const S=Math.min(window.innerWidth-k.offsetWidth-12,Math.max(12,_.left+_.width+10)),H=Math.min(window.innerHeight-k.offsetHeight-12,Math.max(12,_.top));k.style.left=`${S}px`,k.style.top=`${H}px`},[o,t,s]);E(()=>{var v;if(!t)return;p();const h=((v=s[o])==null?void 0:v.anchor)||document.documentElement,_=new ResizeObserver(()=>p());return h&&_.observe(h),window.addEventListener("scroll",p,!0),()=>{_.disconnect(),window.removeEventListener("scroll",p,!0)}},[o,t,p,s]);function i(){r(h=>Math.min(h+1,s.length-1))}function m(){r(h=>Math.max(h-1,0))}function f(){n(!1)}function g(){localStorage.setItem(Ge,"1"),n(!1)}if(!t)return null;const y=s[o];return l("div",{class:"ttt-enhancer","aria-live":"polite",children:[l("div",{class:"ttt-coach-scrim open"}),l("div",{class:"ttt-coach-highlight",ref:a}),l("div",{class:"ttt-coach-panel",ref:d,role:"dialog","aria-label":y.title,children:[l("div",{style:"display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:6px;",children:[l("div",{style:"font-weight:600",children:y.title}),l("button",{class:"ttt-enhancer","aria-label":"Close",onClick:f,style:"pointer-events:auto;background:none;border:none;color:inherit;cursor:pointer",children:l(le,{})})]}),l("div",{style:"opacity:.9; margin-bottom:8px;",children:y.body}),l("div",{style:"display:flex; justify-content:space-between; align-items:center; gap:8px;",children:[l("button",{class:"ttt-enhancer",onClick:g,style:"pointer-events:auto;background:none;border:none;color:inherit;opacity:.8;cursor:pointer",children:"Don’t show again"}),l("div",{style:"display:flex; align-items:center; gap:6px;",children:[l("button",{disabled:o===0,class:"ttt-enhancer",onClick:m,style:"pointer-events:auto;background:none;border:1px solid rgba(255,255,255,.15);border-radius:8px;padding:4px 8px;color:inherit;opacity:${idx===0?'.5':'1'};cursor:${idx===0?'not-allowed':'pointer'}",children:"Prev"}),l("button",{disabled:o===s.length-1,class:"ttt-enhancer",onClick:i,style:"pointer-events:auto;background:var(--color-accent);border:none;border-radius:8px;padding:4px 10px;color:black;cursor:${idx===steps.length-1?'not-allowed':'pointer'}",children:["Next ",l(Ut,{})]})]})]}),l("div",{style:"margin-top:6px; font-size:12px; opacity:.7",children:["Step ",o+1," of ",s.length]})]})]})}function Rt(e){for(const t of e){const n=document.querySelectorAll(t);for(const o of n)if(!o.closest(".ttt-enhancer"))return o}return null}function Ke(e,t,n){return Math.min(n,Math.max(t,e))}let Wt=1;const de=new Set;function P(e){const t={id:Wt++,text:e};de.forEach(n=>n(t))}function jt(){const[e,t]=O([]);return E(()=>{const n=o=>{t(r=>[...r,o]),setTimeout(()=>t(r=>r.filter(a=>a.id!==o.id)),2400)};return de.add(n),()=>{de.delete(n)}},[]),l("div",{"aria-live":"polite",class:"ttt-toasts",children:e.map(n=>l("div",{class:"ttt-toast",role:"status",children:n.text},n.id))})}function Bt({store:e}){const{prefs:t,panelOpen:n}=e.getState(),o=$(null),[r,a]=O(n);E(()=>{const s=e.subscribe(p=>a(p.panelOpen));return()=>s()},[e]),E(()=>{function s(p){p.key==="Escape"&&e.setState({panelOpen:!1})}return r&&document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[r,e]);function d(s,p){const i=e.getState().prefs;e.setState({prefs:{...i,[s]:p}})}function u(){const s=JSON.stringify({prefs:e.getState().prefs},null,2),p=new Blob([s],{type:"application/json"}),i=document.createElement("a");i.href=URL.createObjectURL(p),i.download="ttt-ui-enhancer-preferences.json",i.click(),URL.revokeObjectURL(i.href)}function c(s){var i;const p=(i=s.target.files)==null?void 0:i[0];p&&p.text().then(m=>{try{const f=JSON.parse(m),g=e.getState().prefs;"prefs"in f&&f.prefs?(e.setState({prefs:{...g,...f.prefs}}),P("Preferences imported")):f&&Object.keys(f).length>0?(e.setState({prefs:{...g,...f}}),P("Preferences imported")):P("Preferences file is empty")}catch{P("Unable to import preferences")}}).catch(()=>P("Unable to import preferences"))}return l("div",{class:"ttt-enhancer","aria-live":"polite",children:[l("button",{type:"button",class:"ttt-skip",onClick:()=>{var s,p;return(p=(s=e.getState().discovery.board)==null?void 0:s.focus)==null?void 0:p.call(s)},children:"Skip to Game Board"}),l("button",{class:"ttt-gear","aria-label":"Open settings",onClick:()=>e.setState({panelOpen:!r}),children:l(It,{})}),l("div",{ref:o,class:"ttt-panel"+(r?" open":""),role:"dialog","aria-modal":"false","aria-label":"UI Enhancer Settings",children:[l("div",{class:"ttt-panel-header",children:[l("div",{class:"ttt-panel-title",children:"UI Enhancer"}),l("button",{class:"ttt-enhancer","aria-label":"Close",onClick:()=>e.setState({panelOpen:!1}),style:"pointer-events:auto;background:none;border:none;color:inherit;cursor:pointer",children:l(le,{})})]}),l("div",{class:"ttt-panel-body",children:[l("div",{class:"ttt-panel-controls",children:[l("div",{class:"ttt-row",children:[l("label",{htmlFor:"theme",children:"Theme"}),l("select",{id:"theme",class:"ttt-select",value:t.theme,onChange:s=>d("theme",s.currentTarget.value),children:[l("option",{value:"light",children:"Light"}),l("option",{value:"dark",children:"Dark"}),l("option",{value:"high-contrast",children:"High Contrast"}),l("option",{value:"protanopia",children:"Protanopia-safe"}),l("option",{value:"deuteranopia",children:"Deuteranopia-safe"}),l("option",{value:"tritanopia",children:"Tritanopia-safe"})]})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"font",children:"Font Size"}),l("input",{id:"font",class:"ttt-input",type:"range",min:"0.9",max:"1.3",step:"0.05",value:t.fontScale,onInput:s=>d("fontScale",Ke(parseFloat(s.currentTarget.value),.9,1.3))})," ",l("span",{children:[Math.round(t.fontScale*100),"%"]})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"rm",children:"Reduce Motion"}),l("input",{id:"rm",class:"ttt-checkbox",type:"checkbox",checked:t.reduceMotion,onChange:s=>d("reduceMotion",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"gm",children:"Ghost Marks"}),l("input",{id:"gm",class:"ttt-checkbox",type:"checkbox",checked:t.ghostMarks,onChange:s=>d("ghostMarks",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"snd",children:"Sounds"}),l("input",{id:"snd",class:"ttt-checkbox",type:"checkbox",checked:t.sounds,onChange:s=>d("sounds",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"vol",children:"Volume"}),l("input",{id:"vol",class:"ttt-input",type:"range",min:"0",max:"1",step:"0.05",value:t.volume,onInput:s=>d("volume",Ke(parseFloat(s.currentTarget.value),0,1))})," ",l("span",{children:[Math.round(t.volume*100),"%"]})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"hap",children:"Haptics"}),l("input",{id:"hap",class:"ttt-checkbox",type:"checkbox",checked:t.haptics,onChange:s=>d("haptics",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"tts",children:"Tooltips"}),l("input",{id:"tts",class:"ttt-checkbox",type:"checkbox",checked:t.tooltips,onChange:s=>d("tooltips",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"tips",children:"Tips on Start"}),l("input",{id:"tips",class:"ttt-checkbox",type:"checkbox",checked:t.tipsOnStart,onChange:s=>d("tipsOnStart",s.currentTarget.checked)})]}),l("div",{class:"ttt-row",children:[l("label",{htmlFor:"dys",children:"Dyslexia-friendly Font"}),l("input",{id:"dys",class:"ttt-checkbox",type:"checkbox",checked:t.dyslexiaFont,onChange:s=>d("dyslexiaFont",s.currentTarget.checked)})]}),l("div",{style:"display:flex; gap:8px; align-items:center;",children:[l("button",{class:"ttt-enhancer",onClick:u,style:"pointer-events:auto;background:var(--color-surface);border:1px solid rgba(255,255,255,.15);border-radius:8px;padding:6px 10px;color:inherit;cursor:pointer",children:"Export"}),l("label",{class:"ttt-enhancer",style:"pointer-events:auto;background:var(--color-surface);border:1px solid rgba(255,255,255,.15);border-radius:8px;padding:6px 10px;color:inherit;cursor:pointer",children:["Import ",l("input",{type:"file",accept:"application/json",style:"display:none",onChange:c})]}),l("span",{style:"display:inline-flex; align-items:center; gap:6px; opacity:.8",children:[l(Nt,{})," Preferences stored locally"]})]})]}),l("div",{style:"margin-top:10px; display:flex; gap:8px; align-items:center; opacity:.8",children:[l(Ft,{}),"Press ? for keyboard shortcuts"]})]})]})]})}function zt({store:e}){const{shortcutsOpen:t}=e.getState(),n=ae(()=>{e.setState({shortcutsOpen:!1})},[e]);return E(()=>{if(!t)return;const o=r=>{r.key==="Escape"&&n()};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[n,t]),l("div",{class:"ttt-shortcuts"+(t?" open":""),role:"dialog","aria-modal":"false","aria-label":"Keyboard Shortcuts",children:l("div",{class:"ttt-shortcuts-panel",children:[l("div",{style:"display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;",children:[l("div",{style:"font-weight:600",children:"Keyboard Shortcuts"}),l("button",{class:"ttt-enhancer","aria-label":"Close",onClick:n,style:"pointer-events:auto;background:none;border:none;color:inherit;cursor:pointer",children:l(le,{})})]}),l("ul",{style:"line-height:1.8",children:[l("li",{children:"?: Open this help"}),l("li",{children:"Arrow keys: Navigate squares"}),l("li",{children:"Enter/Space: Activate square"}),l("li",{children:"Esc: Close panels or overlays"})]}),l("p",{style:"opacity:.8; font-size:13px",children:"Note: We do not override the host app’s handlers; navigation hints are additive."})]})})}function qt({store:e,liveRegionId:t}){const[n,o]=O(()=>qe(e)),[r,a]=O(()=>!!e.getState().discovery.board),d=$(null),u=$(n.board);E(()=>{const p=e.subscribe(()=>{const i=qe(e);o(i),a(!!e.getState().discovery.board)});return a(!!e.getState().discovery.board),()=>p()},[e]),E(()=>{const p=e.getState().prefs,i=u.current;if(n.board.findIndex((g,y)=>g&&g!==i[y])>=0&&(p.sounds&&$t(p.volume),p.haptics&&Pt(8)),u.current=n.board.slice(),n.winner){se(t,`${n.winner} wins!`);const g=e.getState().prefs;!g.reduceMotion&&d.current&&Mt(d.current,g.reduceMotion),g.sounds&&At(g.volume),P(`${n.winner} wins!`)}else if(n.draw){se(t,"Game is a draw");const g=e.getState().prefs;g.sounds&&Ht(g.volume),P("Draw game")}else se(t,`${n.next}'s turn`)},[t,n.board,n.draw,n.next,n.winner,e]),E(()=>{const p=i=>{var m,f;if(!(Lt(i)||i.defaultPrevented)&&((i.key==="?"||i.shiftKey&&i.key==="/")&&e.setState({shortcutsOpen:!0}),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(i.key))){const g=e.getState().discovery.cells||[],y=document.activeElement;!g.includes(y)&&g[0]&&((f=(m=g[0]).focus)==null||f.call(m))}};return window.addEventListener("keydown",p,!0),()=>window.removeEventListener("keydown",p,!0)},[e]);const c=e.getState().discovery.board,s=q(()=>{if(!c)return{display:"none"};const p=c.getBoundingClientRect();return{position:"fixed",left:`${p.left}px`,top:`${p.top}px`,width:`${p.width}px`,height:`${p.height}px`}},[c]);return l("div",{class:"ttt-enhancer",children:[!r&&l("div",{class:"ttt-toast",style:"position:fixed; right:12px; bottom:12px; pointer-events:none;",children:"UI Enhancer idle—app not detected."}),l("div",{ref:d,class:"ttt-overlay",style:s,"aria-hidden":"true",children:l(Gt,{store:e,status:n})}),l(Bt,{store:e}),l(zt,{store:e}),l(Dt,{store:e}),l(jt,{})]})}function Gt({status:e,store:t}){const[n,o]=O(null),r=$(null),a=ae(()=>{const d=r.current,u=d==null?void 0:d.parentElement;if(!d||!u)return;d.width=u.clientWidth,d.height=u.clientHeight;const c=d.getContext("2d");if(!c)return;c.clearRect(0,0,d.width,d.height);const s=d.width,p=d.height,i=Math.min(s,p)/3,m=(s-i*3)/2,f=(p-i*3)/2;c.strokeStyle="rgba(255,255,255,0.18)",c.lineWidth=2;for(let y=1;y<3;y++){const h=Math.round(m+i*y)+.5,_=Math.round(f+i*y)+.5;c.beginPath(),c.moveTo(h,f),c.lineTo(h,f+i*3),c.stroke(),c.beginPath(),c.moveTo(m,_),c.lineTo(m+i*3,_),c.stroke()}if(e.winLine){c.strokeStyle=getComputedStyle(document.querySelector(".ttt-enhancer-root")||document.body).getPropertyValue("--color-win").trim()||"#30d158",c.lineWidth=6,c.lineCap="round";const[y,,h]=e.winLine,_=S=>({x:m+i*(S%3)+i/2,y:f+i*Math.floor(S/3)+i/2}),v=_(y),k=_(h);Kt(c,v.x,v.y,k.x,k.y)}if(t.getState().prefs.ghostMarks&&n!=null){const y=n,h=m+i*(y%3)+i/2,_=f+i*Math.floor(y/3)+i/2;if(c.save(),c.strokeStyle="rgba(106,169,255,0.75)",c.lineWidth=2,c.setLineDash([6,4]),c.strokeRect(m+i*(y%3)+6,f+i*Math.floor(y/3)+6,i-12,i-12),c.restore(),c.save(),c.globalAlpha=.35,c.strokeStyle=getComputedStyle(document.querySelector(".ttt-enhancer-root")||document.body).getPropertyValue("--color-accent").trim()||"#6aa9ff",c.lineWidth=3,e.next==="X"){const v=i*.28;c.beginPath(),c.moveTo(h-v,_-v),c.lineTo(h+v,_+v),c.stroke(),c.beginPath(),c.moveTo(h+v,_-v),c.lineTo(h-v,_+v),c.stroke()}else c.beginPath(),c.arc(h,_,i*.32,0,Math.PI*2),c.stroke();c.restore()}},[n,e,t]);return E(()=>{var c;a();const d=new ResizeObserver(a),u=(c=r.current)==null?void 0:c.parentElement;return u&&d.observe(u),()=>d.disconnect()},[a]),E(()=>{const d=t.getState().discovery.cells??[];if(!d.length)return;const u=()=>o(null),c=d.map((s,p)=>()=>o(p));return d.forEach((s,p)=>{const i=c[p];s.addEventListener("mouseenter",i),s.addEventListener("focus",i),s.addEventListener("mouseleave",u),s.addEventListener("blur",u)}),()=>{d.forEach((s,p)=>{const i=c[p];s.removeEventListener("mouseenter",i),s.removeEventListener("focus",i),s.removeEventListener("mouseleave",u),s.removeEventListener("blur",u)})}},[e,t]),l("canvas",{ref:r,class:"ttt-canvas","aria-hidden":"true"})}function Kt(e,t,n,o,r){let d=0;const u=matchMedia("(prefers-reduced-motion: reduce)").matches,c=()=>{d++;const s=u?1:Math.min(1,d/24),p=t+(o-t)*s,i=n+(r-n)*s;e.beginPath(),e.moveTo(t,n),e.lineTo(p,i),e.stroke(),!u&&s<1&&requestAnimationFrame(c)};c()}let ue=!1;function pe(){if(ue)return;ue=!0;const e="ttt-ui-enhancer-root",t="ttt-ui-enhancer-styles",n=document.getElementById(e);n&&n.remove(),kt(t);const o=document.createElement("div");o.id=e,o.className="ttt-enhancer-root ttt-enhancer",o.style.position="fixed",o.style.inset="0",o.style.pointerEvents="none",o.setAttribute("aria-hidden","true"),document.body.appendChild(o);const r=document.createElement("div");r.id="ttt-ui-enhancer-live",r.className="ttt-enhancer",r.setAttribute("aria-live","polite"),r.setAttribute("role","status"),r.style.position="fixed",r.style.left="-9999px",r.style.top="auto",r.style.width="1px",r.style.height="1px",document.body.appendChild(r);const a=ft(pt()),d=Me(),u=dt(()=>{const c=Me();a.setState({discovery:c})});a.setState({discovery:d}),Le(be(qt,{store:a,liveRegionId:r.id}),o),window.addEventListener("pagehide",()=>{try{u()}catch{}try{Le(null,o)}catch{}try{o.remove()}catch{}try{r.remove()}catch{}ue=!1})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>pe()):pe(),_e.attachEnhancer=pe,Object.defineProperty(_e,Symbol.toStringTag,{value:"Module"})})(this.TTTEnhancer=this.TTTEnhancer||{});
