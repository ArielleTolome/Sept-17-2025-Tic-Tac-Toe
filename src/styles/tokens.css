:root .ttt-enhancer,
.ttt-enhancer :root {
  /* Colors */
  --color-bg: #0b0c0f;
  --color-surface: #151821;
  --color-text: #e6eaf2;
  --color-muted: #a7b0c3;
  --color-accent: #6aa9ff;
  --color-win: #30d158;
  --color-lose: #ff453a;
  --color-draw: #ffd60a;
  --ring-focus: 0 0 0 3px rgba(106, 169, 255, 0.55);

  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.2);
  --shadow-md: 0 8px 20px rgba(0,0,0,0.35);
  --shadow-lg: 0 22px 60px rgba(0,0,0,0.45);

  /* Radii */
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 16px;
  --radius-xl: 24px;

  /* Spacing */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 24px;
  --space-6: 32px;
  --space-7: 48px;
  --space-8: 64px;

  /* Typography */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  --font-dyslexia: "OpenDyslexic", var(--font-sans);
  --font-scale: 1;

  /* Component styles */
  --panel-bg: color-mix(in srgb, var(--color-surface) 85%, black 15%);
  --panel-border: 1px solid rgba(255,255,255,0.08);
}

/* Base namespace */
.ttt-enhancer {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  font-family: var(--font-sans);
}

/* Root overlay container */
.ttt-enhancer-root {
  z-index: 2147483646; /* below browser UI but above page */
}

/* Gear button */
.ttt-enhancer .ttt-gear {
  position: fixed;
  right: calc(12px + var(--safe-right));
  bottom: calc(12px + var(--safe-bottom));
  width: 44px; height: 44px;
  border-radius: 999px;
  background: var(--panel-bg);
  box-shadow: var(--shadow-md);
  border: var(--panel-border);
  display: grid; place-items: center;
  color: var(--color-text);
  pointer-events: auto;
  cursor: pointer;
}
.ttt-enhancer .ttt-gear:focus-visible {
  outline: none; box-shadow: var(--ring-focus);
}

/* Side panel */
.ttt-enhancer .ttt-panel {
  position: fixed; pointer-events: auto;
  right: calc(12px + var(--safe-right));
  bottom: calc(64px + 20px + var(--safe-bottom));
  width: min(420px, calc(100vw - 24px));
  max-height: min(70vh, calc(100vh - 160px));
  background: var(--panel-bg);
  color: var(--color-text);
  border-radius: var(--radius-lg);
  border: var(--panel-border);
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  display: none;
}
.ttt-enhancer .ttt-panel.open { display: grid; grid-template-rows: auto 1fr; }
.ttt-enhancer .ttt-panel-header { display:flex; align-items:center; justify-content:space-between; padding: var(--space-3) var(--space-4); border-bottom: var(--panel-border); }
.ttt-enhancer .ttt-panel-title { font-weight: 600; }
.ttt-enhancer .ttt-panel-body { padding: var(--space-4); overflow: auto; }
.ttt-enhancer .ttt-panel-controls { display:grid; gap: var(--space-3); }
.ttt-enhancer .ttt-row { display:flex; align-items:center; justify-content:space-between; gap: var(--space-3); }
.ttt-enhancer .ttt-row > label { font-size: 14px; color: var(--color-muted); }
.ttt-enhancer .ttt-select, .ttt-enhancer .ttt-input, .ttt-enhancer .ttt-checkbox {
  pointer-events: auto;
}

/* Skip link */
.ttt-enhancer .ttt-skip {
  position: fixed; left: calc(8px + var(--safe-left)); top: calc(8px + var(--safe-top));
  padding: 8px 12px; background: var(--color-surface); color: var(--color-text);
  border-radius: var(--radius-md); border: var(--panel-border); box-shadow: var(--shadow-sm);
  opacity: 0; pointer-events: none; transform: translateY(-6px);
}
.ttt-enhancer .ttt-skip:focus { opacity: 1; pointer-events: auto; transform: none; box-shadow: var(--ring-focus); outline: none; }

/* Tooltip */
.ttt-enhancer .ttt-tooltip { position: fixed; background: var(--color-surface); color: var(--color-text); border: var(--panel-border); border-radius: var(--radius-sm); box-shadow: var(--shadow-sm); padding: 6px 8px; font-size: 12px; opacity: 0; pointer-events: none; transition: opacity .12s ease }
.ttt-enhancer .ttt-tooltip.show { opacity: 1 }

/* Toasts */
.ttt-enhancer .ttt-toasts { position: fixed; left: 50%; transform: translateX(-50%); bottom: calc(80px + var(--safe-bottom)); display:grid; gap:8px; pointer-events:none; }
.ttt-enhancer .ttt-toast { background: var(--color-surface); color: var(--color-text); border: var(--panel-border); border-radius: var(--radius-md); box-shadow: var(--shadow-md); padding: 8px 12px; }

/* Overlay canvas and layers */
.ttt-enhancer .ttt-overlay { position: absolute; inset: 0; pointer-events: none; }
.ttt-enhancer .ttt-canvas { position:absolute; inset:0; }

/* Shortcuts overlay */
.ttt-enhancer .ttt-shortcuts { position: fixed; inset: 0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.5); backdrop-filter: blur(6px); pointer-events:auto; }
.ttt-enhancer .ttt-shortcuts.open { display:flex; }
.ttt-enhancer .ttt-shortcuts-panel { width:min(720px, 92vw); max-height:80vh; overflow:auto; background: var(--panel-bg); color: var(--color-text); border: var(--panel-border); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); padding: 18px 20px; }

/* Coach marks */
.ttt-enhancer .ttt-coach-scrim { position: fixed; inset:0; background: rgba(0,0,0,.55); pointer-events:auto; display:none; }
.ttt-enhancer .ttt-coach-scrim.open { display:block; }
.ttt-enhancer .ttt-coach-highlight { position: fixed; border-radius: 12px; outline: 2px dashed var(--color-accent); outline-offset: 2px; pointer-events:none; }
.ttt-enhancer .ttt-coach-panel { position: fixed; max-width: min(420px, 92vw); background: var(--panel-bg); color: var(--color-text); border: var(--panel-border); border-radius: var(--radius-lg); box-shadow: var(--shadow-md); padding: 12px 14px; pointer-events:auto; }

/* Skeleton shimmer */
.ttt-enhancer .ttt-skeleton { background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.12), rgba(255,255,255,0.06)); background-size: 200% 100%; animation: ttt-shimmer 1.2s infinite; }
@keyframes ttt-shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

/* Typography scale */
.ttt-enhancer { font-size: calc(16px * var(--font-scale)); }

/* High-contrast text helpers */
.ttt-enhancer .hc-text { color: var(--color-text); text-shadow: 0 1px 0 rgba(0,0,0,.6); }
